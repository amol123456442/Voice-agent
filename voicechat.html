<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced System Voice Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-size: 32px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .mic-container {
            margin: 30px 0;
            position: relative;
        }

        #micBtn {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4);
            color: white;
            border: none;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 0 auto;
        }

        #micBtn:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
        }

        #micBtn.listening {
            background: linear-gradient(45deg, #ff4b4b, #ff7676);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        #micBtn svg {
            width: 35px;
            height: 35px;
        }

        .timer {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff4b4b;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        #status, #result {
            margin: 20px 0;
            font-size: 18px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        #result {
            color: #ffd166;
            font-weight: bold;
        }

        .success {
            color: #4ade80;
        }

        .error {
            color: #f87171;
        }

        .transcript {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 14px;
            text-align: left;
            max-height: 100px;
            overflow-y: auto;
        }

        .instructions {
            margin-top: 25px;
            font-size: 14px;
            opacity: 0.8;
            line-height: 1.5;
        }

        .examples {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .examples h3 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .example-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        .example {
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .system-integration {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            text-align: left;
        }

        .system-integration h3 {
            margin-bottom: 15px;
            text-align: center;
        }

        .integration-methods {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .method {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .method h4 {
            margin-bottom: 10px;
            color: #ffd166;
        }

        .method p {
            font-size: 12px;
            margin-bottom: 10px;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 11px;
            overflow-x: auto;
        }

        .demo-section {
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .demo-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .demo-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .demo-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéôÔ∏è Advanced System Voice Assistant</h1>
        <p class="subtitle">Real system control with voice commands - Implementation Guide</p>
        
        <div class="mic-container">
            <button id="micBtn">
                <svg viewBox="0 0 24 24">
                    <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z" fill="white"/>
                </svg>
                Start Listening
            </button>
        </div>
        
        <div id="status">Click the microphone and speak your command</div>
        <div id="result">Ready to listen...</div>
        
        <div class="transcript" id="transcript">
            <strong>Live Transcript:</strong><br>
            <span id="transcriptText">Waiting for speech...</span>
        </div>

        <div class="demo-section">
            <h3>Quick Demo (Web-safe operations)</h3>
            <div class="demo-buttons">
                <button class="demo-btn" onclick="openWebsite('https://www.google.com')">Open Google</button>
                <button class="demo-btn" onclick="openWebsite('https://www.youtube.com')">Open YouTube</button>
                <button class="demo-btn" onclick="showSystemCommand('notepad')">Show Notepad Command</button>
                <button class="demo-btn" onclick="showSystemCommand('calculator')">Show Calculator Command</button>
            </div>
        </div>
        
        <div class="examples">
            <h3>Try saying:</h3>
            <div class="example-list">
                <div class="example" onclick="speakExample('open google.com')">"open google.com"</div>
                <div class="example" onclick="speakExample('open notepad')">"open notepad"</div>
                <div class="example" onclick="speakExample('open calculator')">"open calculator"</div>
                <div class="example" onclick="speakExample('show downloads')">"show downloads"</div>
                <div class="example" onclick="speakExample('system info')">"system info"</div>
            </div>
        </div>

        <div class="system-integration">
            <h3>üîß Real System Integration Methods</h3>
            <p>Web browsers can't directly control your OS due to security restrictions. Here are solutions:</p>
            
            <div class="integration-methods">
                <div class="method">
                    <h4>1. Electron App</h4>
                    <p>Create a desktop application with system access:</p>
                    <div class="code-block">
// main.js (Electron)<br>
const { app, BrowserWindow, shell } = require('electron');<br>
const { exec } = require('child_process');<br><br>
// Open Notepad<br>
function openNotepad() {<br>
&nbsp;&nbsp;exec('notepad.exe');<br>
}<br><br>
// Open Calculator<br>
function openCalculator() {<br>
&nbsp;&nbsp;exec('calc.exe');<br>
}
                    </div>
                </div>
                
                <div class="method">
                    <h4>2. Chrome Extension</h4>
                    <p>Native messaging with a desktop companion:</p>
                    <div class="code-block">
// background.js (Chrome Extension)<br>
chrome.runtime.onMessage.addListener((request) => {<br>
&nbsp;&nbsp;if (request.action === 'openApp') {<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Send to native app<br>
&nbsp;&nbsp;&nbsp;&nbsp;chrome.runtime.sendNativeMessage(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'com.yourapp.systemcontrol',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ command: request.app }<br>
&nbsp;&nbsp;&nbsp;&nbsp;);<br>
&nbsp;&nbsp;}<br>
});
                    </div>
                </div>
                
                <div class="method">
                    <h4>3. Windows Script Host</h4>
                    <p>Use VBScript/JavaScript for system commands:</p>
                    <div class="code-block">
// system.js (Windows Script)<br>
var shell = new ActiveXObject("WScript.Shell");<br><br>
// Open Notepad<br>
shell.Run("notepad.exe");<br><br>
// Open Calculator<br>
shell.Run("calc.exe");<br><br>
// Shutdown (with delay)<br>
shell.Run("shutdown /s /t 30");
                    </div>
                </div>
                
                <div class="method">
                    <h4>4. Python Backend</h4>
                    <p>Web server with system access:</p>
                    <div class="code-block">
# app.py (Flask)<br>
from flask import Flask<br>
import os<br><br>
app = Flask(__name__)<br><br>
@app.route('/open/<app_name>')<br>
def open_app(app_name):<br>
&nbsp;&nbsp;if app_name == 'notepad':<br>
&nbsp;&nbsp;&nbsp;&nbsp;os.system('notepad.exe')<br>
&nbsp;&nbsp;elif app_name == 'calculator':<br>
&nbsp;&nbsp;&nbsp;&nbsp;os.system('calc.exe')<br>
&nbsp;&nbsp;return 'OK'
                    </div>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <p>üéØ <strong>Immediate Solution:</strong> Use the demo buttons above for web-safe operations</p>
            <p>üöÄ <strong>Real System Control:</strong> Implement one of the integration methods shown above</p>
            <p>üîí <strong>Security Note:</strong> Browser restrictions protect your system from malicious websites</p>
        </div>
    </div>

    <script>
        // Core Configuration
        const config = {
            listeningTime: 5
        };

        // DOM Elements
        const elements = {
            micBtn: document.getElementById('micBtn'),
            status: document.getElementById('status'),
            result: document.getElementById('result'),
            transcript: document.getElementById('transcriptText')
        };

        // State Management
        const state = {
            isListening: false
        };

        // Speech Recognition Setup
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = 'en-US';

        // Command Patterns
        const commandPatterns = {
            applications: {
                'notepad': { name: 'Notepad', command: 'notepad.exe', webSafe: false },
                'calculator': { name: 'Calculator', command: 'calc.exe', webSafe: false },
                'paint': { name: 'Paint', command: 'mspaint.exe', webSafe: false },
                'cmd': { name: 'Command Prompt', command: 'cmd.exe', webSafe: false },
                'task manager': { name: 'Task Manager', command: 'taskmgr.exe', webSafe: false }
            },
            
            system: {
                'shutdown': { name: 'Shutdown', command: 'shutdown /s /t 30', webSafe: false },
                'restart': { name: 'Restart', command: 'shutdown /r /t 30', webSafe: false },
                'sleep': { name: 'Sleep', command: 'rundll32.exe powrprof.dll,SetSuspendState 0,1,0', webSafe: false },
                'lock': { name: 'Lock Computer', command: 'rundll32.exe user32.dll,LockWorkStation', webSafe: false }
            },
            
            files: {
                'downloads': { name: 'Downloads Folder', path: '%USERPROFILE%\\Downloads', webSafe: false },
                'documents': { name: 'Documents Folder', path: '%USERPROFILE%\\Documents', webSafe: false },
                'desktop': { name: 'Desktop', path: '%USERPROFILE%\\Desktop', webSafe: false }
            }
        };

        // Core Functions
        function processCommand(text) {
            const lowerText = text.toLowerCase().trim();
            console.log("Processing command:", lowerText);
            
            // Website commands
            if (lowerText.includes('open ') && /\.(com|org|net|io|in)$/.test(lowerText)) {
                const domain = extractDomain(text);
                if (domain && domain.type === 'domain') {
                    openWebsite(domain.value);
                    return;
                }
            }
            
            // Search commands
            if (lowerText.includes('search for ') || lowerText.includes('find ')) {
                const query = lowerText.replace(/(search for|find)\s+/gi, '').trim();
                if (query) {
                    performSearch(query);
                    return;
                }
            }
            
            // System application commands
            for (const [key, config] of Object.entries(commandPatterns.applications)) {
                if (lowerText.includes(key)) {
                    showSystemIntegration(key, config);
                    return;
                }
            }
            
            // System actions
            for (const [key, config] of Object.entries(commandPatterns.system)) {
                if (lowerText.includes(key)) {
                    showSystemIntegration(key, config);
                    return;
                }
            }
            
            // File operations
            for (const [key, config] of Object.entries(commandPatterns.files)) {
                if (lowerText.includes(key)) {
                    showSystemIntegration(key, config);
                    return;
                }
            }
            
            // System info
            if (lowerText.includes('system info') || lowerText.includes('system information')) {
                showSystemInfo();
                return;
            }
            
            // Unknown command
            elements.result.innerHTML = `‚ùì Command: "${text}"`;
            elements.status.innerHTML = `<span class="error">Browser cannot execute system commands directly</span>`;
        }

        function showSystemIntegration(command, config) {
            elements.result.innerHTML = `‚ö° ${config.name}`;
            elements.status.innerHTML = `<span class="error">üîí Browser Security Restriction</span>`;
            
            // Show the actual command that would be executed
            setTimeout(() => {
                const commandText = config.command || config.path;
                alert(`System Command: ${commandText}\n\nTo actually run this, implement one of the integration methods shown below.`);
            }, 1000);
        }

        function showSystemCommand(appName) {
            const config = commandPatterns.applications[appName];
            if (config) {
                alert(`To open ${config.name}:\n\nCommand: ${config.command}\n\nThis requires system-level access through Electron, Chrome Extension, or desktop application.`);
            }
        }

        function showSystemInfo() {
            const info = `
Browser: ${navigator.userAgent}
Platform: ${navigator.platform}
Language: ${navigator.language}
Cookies: ${navigator.cookieEnabled ? 'Enabled' : 'Disabled'}
Java: ${navigator.javaEnabled ? 'Enabled' : 'Disabled'}
Screen: ${screen.width}x${screen.height}
            `.trim();
            
            elements.result.innerHTML = `üíª System Information`;
            elements.status.innerHTML = `<span class="success">${info.replace(/\n/g, '<br>')}</span>`;
        }

        function openWebsite(domain) {
            let cleanDomain = domain.toLowerCase().trim();
            if (!cleanDomain.startsWith('http')) {
                cleanDomain = 'https://' + cleanDomain;
            }
            
            elements.result.innerHTML = `üåê Opening: <strong>${domain}</strong>`;
            elements.status.innerHTML = `<span class="success">‚úÖ Opening website...</span>`;
            
            setTimeout(() => {
                try {
                    const link = document.createElement('a');
                    link.href = cleanDomain;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    elements.status.innerHTML = `<span class="success">‚úÖ Successfully opened ${domain}</span>`;
                } catch (e) {
                    elements.status.innerHTML = `<span class="error">‚ùå Failed to open ${domain}</span>`;
                }
            }, 1000);
        }

        function performSearch(query) {
            const searchUrl = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
            elements.result.innerHTML = `üîç Searching: <strong>${query}</strong>`;
            elements.status.innerHTML = `<span class="success">‚úÖ Performing search...</span>`;
            
            setTimeout(() => {
                try {
                    const link = document.createElement('a');
                    link.href = searchUrl;
                    link.target = '_blank';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    elements.status.innerHTML = `<span class="success">‚úÖ Searching for: ${query}</span>`;
                } catch (e) {
                    elements.status.innerHTML = `<span class="error">‚ùå Failed to search</span>`;
                }
            }, 1000);
        }

        // Utility Functions
        function extractDomain(text) {
            const domainRegex = /([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.(?:[a-zA-Z]{2,}|co\.[a-zA-Z]{2}|com\.[a-zA-Z]{2}|org\.[a-zA-Z]{2}|net\.[a-zA-Z]{2}|io|in))(?:\s|$)/i;
            const match = text.match(domainRegex);
            return match ? { type: 'domain', value: match[1] } : null;
        }

        function startListening() {
            if (state.isListening) return;

            state.isListening = true;
            elements.micBtn.classList.add('listening');
            elements.micBtn.innerHTML = `Listening...`;
            
            // Timer
            const timer = document.createElement('div');
            timer.className = 'timer';
            timer.id = 'listenTimer';
            timer.textContent = config.listeningTime;
            elements.micBtn.parentElement.appendChild(timer);

            elements.status.textContent = "üé§ Listening... Speak your command";
            elements.result.textContent = "Processing...";
            elements.transcript.textContent = "Listening...";

            let seconds = config.listeningTime;
            const timerInterval = setInterval(() => {
                seconds--;
                timer.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(timerInterval);
                    stopListening();
                }
            }, 1000);

            recognition.start();
        }

        function stopListening() {
            state.isListening = false;
            elements.micBtn.classList.remove('listening');
            elements.micBtn.innerHTML = `Start Listening`;
            
            const timer = document.getElementById('listenTimer');
            if (timer) timer.remove();
            
            recognition.stop();
            elements.status.textContent = "Click microphone to start listening";
            elements.transcript.textContent = "Session ended";
        }

        function speakExample(text) {
            elements.transcript.textContent = text;
            processCommand(text);
        }

        // Event Listeners
        elements.micBtn.addEventListener('click', () => {
            state.isListening ? stopListening() : startListening();
        });

        recognition.onresult = (event) => {
            let finalTranscript = '';
            for (let i = event.resultIndex; i < event.results.length; i++) {
                if (event.results[i].isFinal) {
                    finalTranscript += event.results[i][0].transcript;
                }
            }
            
            if (finalTranscript) {
                elements.transcript.textContent = finalTranscript;
                processCommand(finalTranscript);
            }
        };

        recognition.onerror = (event) => {
            console.error('Speech recognition error:', event.error);
            if (event.error === 'not-allowed') {
                elements.status.innerHTML = `<span class="error">‚ùå Microphone access denied. Please allow microphone permissions.</span>`;
            } else {
                elements.status.innerHTML = `<span class="error">‚ùå Error: ${event.error}</span>`;
            }
            stopListening();
        };

        recognition.onend = () => {
            if (state.isListening) {
                setTimeout(() => recognition.start(), 100);
            }
        };

        // Initialize
        console.log("üéØ Advanced System Voice Assistant Ready!");
        console.log("Note: System commands require desktop application implementation");
    </script>
</body>
</html>
